<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#6C5CE7" />
  <title>Timebox</title>

  <style>
    :root{
      --bg:#f5f6fb;
      --card:#ffffff;
      --text:#1f2330;
      --muted:#6b7280;
      --primary:#6C5CE7;
      --line:#e7e9f2;
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", sans-serif;
      background:var(--bg);
      color:var(--text);
    }
    .wrap{
      max-width:720px;
      margin:0 auto;
      padding:16px 14px 28px;
    }
    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      padding:14px;
      margin:12px 0;
    }
    .motivate{
      background: linear-gradient(90deg, var(--primary), #5b9df6);
      color:#fff;
      border:none;
      padding:16px 14px;
      font-weight:800;
      font-size:18px;
      text-align:center;
      letter-spacing:-0.2px;
    }

    /* Date row (simple) */
    .dateRow{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      padding:14px 10px;
    }
    .navBtn{
      border:none;
      background:transparent;
      color:var(--text);
      font-size:28px;
      line-height:1;
      padding:6px 10px;
      border-radius:12px;
      cursor:pointer;
    }
    .navBtn:active{ background:#eef0fb; }
    .dateText{
      font-size:22px;
      font-weight:800;
      letter-spacing:-0.3px;
    }
    .calBtn{
      border:none;
      background:#eef0fb;
      width:38px;
      height:38px;
      border-radius:12px;
      display:grid;
      place-items:center;
      cursor:pointer;
    }
    .calBtn:active{ filter:brightness(0.97); }

    /* Section header */
    .sectionHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:10px;
    }
    .sectionTitle{
      display:flex;
      align-items:center;
      gap:10px;
      font-weight:900;
      letter-spacing:-0.2px;
    }
    .iconBox{
      width:34px;height:34px;
      border-radius:12px;
      background:#eef0fb;
      display:grid;place-items:center;
    }
    .addBtn{
      border:none;
      background:var(--text);
      color:#fff;
      width:42px;height:42px;
      border-radius:14px;
      display:grid;place-items:center;
      cursor:pointer;
      font-size:22px;
      font-weight:900;
    }
    .addBtn:active{ filter:brightness(0.92); }

    /* TODO list */
    .todoList{ display:flex; flex-direction:column; gap:8px; }
    .todoItem{
      border:1px solid var(--line);
      border-radius:14px;
      padding:10px 10px;
      display:flex;
      align-items:center;
      gap:10px;
      background:#fff;
      position:relative;
    }
    .check{
      width:22px;height:22px;
      border:2px solid #c8cbe0;
      border-radius:6px;
      display:grid;place-items:center;
      flex:0 0 auto;
      cursor:pointer;
      user-select:none;
    }
    .check.done{
      border-color:var(--primary);
      background:var(--primary);
      color:#fff;
    }
    .todoText{
      flex:1 1 auto;
      border:none;
      outline:none;
      font-size:16px;
      padding:6px 4px;
      background:transparent;
    }
    .todoText.done{
      text-decoration: line-through;
      color:#9aa0b4;
    }
    .trashBtn{
      border:none;
      background:transparent;
      width:38px;height:38px;
      border-radius:12px;
      display:none;          /* Í∏∞Î≥∏ Ïà®ÍπÄ */
      place-items:center;
      cursor:pointer;
    }
    .todoItem.active .trashBtn{ display:grid; } /* Ìï≠Î™© ÌÉ≠ÌïòÎ©¥ Î≥¥Ïù¥Í∏∞ */
    .trashBtn:active{ background:#f3f4f6; }

    /* Brain dump */
    textarea{
      width:100%;
      min-height:140px;
      border:1px solid var(--line);
      border-radius:14px;
      padding:12px;
      font-size:15px;
      outline:none;
      resize:vertical;
      background:#fff;
    }

    /* Time plan (hourly) */
    .grid{
      width:100%;
      border:1px solid var(--line);
      border-radius:14px;
      overflow:hidden;
      background:#fff;
    }
    .row{
      display:grid;
      grid-template-columns: 84px 1fr;
      border-top:1px solid var(--line);
    }
    .row:first-child{ border-top:none; }
    .timeCell{
      padding:12px 10px;
      background:#fafbff;
      color:#404556;
      font-weight:800;
      border-right:1px solid var(--line);
    }
    .planInput{
      padding:10px 10px;
      border:none;
      outline:none;
      font-size:15px;
      background:#fff;
    }

    /* Simple SVG icons */
    svg{ display:block }
  </style>
</head>

<body>
  <div class="wrap">
    <!-- 1) Motivation on top -->
    <div class="card motivate" id="motivation">Ïò§ÎäòÎèÑ Î©ãÏßÑ ÌïòÎ£® ÎêòÏÑ∏Ïöî! üéØ</div>

    <!-- 2) Date row (simple arrows + calendar) -->
    <div class="card">
      <div class="dateRow">
        <button class="navBtn" id="prevDay" aria-label="Ïù¥Ï†Ñ ÎÇ†Ïßú">‚Äπ</button>

        <button class="calBtn" id="openCalendar" aria-label="Îã¨Î†• Ïó¥Í∏∞">
          <!-- simple calendar icon -->
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M7 3v3M17 3v3M4 8h16M6 6h12a2 2 0 0 1 2 2v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2Z" stroke="#1f2330" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>

        <div class="dateText" id="dateLabel">-</div>
        <button class="navBtn" id="nextDay" aria-label="Îã§Ïùå ÎÇ†Ïßú">‚Ä∫</button>
      </div>
    </div>

    <!-- 3) TODO -->
    <div class="card">
      <div class="sectionHead">
        <div class="sectionTitle">
          <div class="iconBox" aria-hidden="true">
            <!-- simple list icon -->
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <path d="M8 6h13M8 12h13M8 18h13" stroke="#1f2330" stroke-width="2" stroke-linecap="round"/>
              <path d="M3 6h.01M3 12h.01M3 18h.01" stroke="#1f2330" stroke-width="4" stroke-linecap="round"/>
            </svg>
          </div>
          <span>TO DO LIST</span>
        </div>

        <button class="addBtn" id="addTodo" aria-label="Ìï† Ïùº Ï∂îÍ∞Ä">+</button>
      </div>

      <div class="todoList" id="todoList"></div>
    </div>

    <!-- Brain dump -->
    <div class="card">
      <div class="sectionHead">
        <div class="sectionTitle">
          <div class="iconBox" aria-hidden="true">
            <!-- simple brain-ish icon -->
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <path d="M9 4c-2 0-4 1.5-4 4v8c0 2.2 1.8 4 4 4" stroke="#1f2330" stroke-width="2" stroke-linecap="round"/>
              <path d="M15 4c2 0 4 1.5 4 4v8c0 2.2-1.8 4-4 4" stroke="#1f2330" stroke-width="2" stroke-linecap="round"/>
              <path d="M9 10h6M9 14h6" stroke="#1f2330" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </div>
          <span>BRAIN DUMP</span>
        </div>
      </div>
      <textarea id="brainDump" placeholder="ÏÉùÍ∞ÅÏùÑ ÏûêÏú†Î°≠Í≤å Ï†ÅÏñ¥Î≥¥ÏÑ∏Ïöî."></textarea>
    </div>

    <!-- 4) TIME PLAN (hourly) -->
    <div class="card">
      <div class="sectionHead">
        <div class="sectionTitle">
          <div class="iconBox" aria-hidden="true">
            <!-- simple clock icon (section only) -->
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <path d="M12 7v6l4 2" stroke="#1f2330" stroke-width="2" stroke-linecap="round"/>
              <path d="M12 22a10 10 0 1 0 0-20 10 10 0 0 0 0 20Z" stroke="#1f2330" stroke-width="2"/>
            </svg>
          </div>
          <span>TIME PLAN</span>
        </div>
      </div>

      <div class="grid" id="timeGrid"></div>
    </div>
  </div>

  <script>
    // ====== Utils ======
    const pad2 = (n) => String(n).padStart(2, "0");
    const ymd = (d) => `${d.getFullYear()}-${pad2(d.getMonth()+1)}-${pad2(d.getDate())}`;
    const formatKor = (d) => {
      const week = ["Ïùº","Ïõî","Ìôî","Ïàò","Î™©","Í∏à","ÌÜ†"][d.getDay()];
      return `${d.getMonth()+1}Ïõî ${d.getDate()}Ïùº (${week})`;
    };

    // ====== State ======
    let current = new Date();
    current.setHours(0,0,0,0);

    // ÏãúÍ∞Ñ Î≤îÏúÑ(ÏõêÌïòÎ©¥ Ïó¨Í∏∞Îßå ÏàòÏ†ï)
    const START_HOUR = 5;
    const END_HOUR = 22; // Ìè¨Ìï®

    // ====== Storage keys ======
    const keyTodo = (dateStr) => `tb:todo:${dateStr}`;
    const keyBrain = (dateStr) => `tb:brain:${dateStr}`;
    const keyPlan = (dateStr) => `tb:plan:${dateStr}`;

    // ====== Date render ======
    const dateLabel = document.getElementById("dateLabel");
    function renderDate(){
      const ds = ymd(current);
      dateLabel.textContent = formatKor(current);
      // load per-day
      loadTodos(ds);
      loadBrain(ds);
      loadPlan(ds);
      renderTimeGrid(ds);
    }

    document.getElementById("prevDay").onclick = () => {
      current.setDate(current.getDate()-1);
      renderDate();
    };
    document.getElementById("nextDay").onclick = () => {
      current.setDate(current.getDate()+1);
      renderDate();
    };

    // (Îã¨Î†• UIÎäî Ïù¥ÌõÑ Îã®Í≥ÑÏóêÏÑú Î™®Îã¨Î°ú Î∂ôÏù¥Î©¥ Îê®)
    document.getElementById("openCalendar").onclick = () => {
      alert("Îã¨Î†• Î™®Îã¨ÏùÄ Îã§Ïùå Îã®Í≥ÑÏóêÏÑú Î∂ôÏùºÍ≤åÏöî. (ÏõêÌïòÎ©¥ Î∞îÎ°ú Ï∂îÍ∞ÄÌï¥ÎìúÎ¶º)");
    };

    // ====== TODO ======
    const todoListEl = document.getElementById("todoList");
    let todos = []; // {id,text,done}

    function saveTodos(ds){
      localStorage.setItem(keyTodo(ds), JSON.stringify(todos));
    }
    function loadTodos(ds){
      todos = JSON.parse(localStorage.getItem(keyTodo(ds)) || "[]");
      renderTodos(ds);
    }

    function renderTodos(ds){
      todoListEl.innerHTML = "";
      if(todos.length === 0){
        // ÏµúÏÜå 1Ï§Ñ Î≥¥Ïù¥Í≤å(ÏõêÌïòÎ©¥ Ï†úÍ±∞ Í∞ÄÎä•)
        addTodoItem(ds, { id: crypto.randomUUID(), text: "", done:false }, true);
        return;
      }
      todos.forEach(t => addTodoItem(ds, t, false));
    }

    function addTodoItem(ds, t, autofocus){
      const item = document.createElement("div");
      item.className = "todoItem";
      item.dataset.id = t.id;

      const check = document.createElement("div");
      check.className = "check" + (t.done ? " done" : "");
      check.innerHTML = t.done ? "‚úì" : "";
      check.onclick = (e) => {
        e.stopPropagation();
        t.done = !t.done;
        saveTodos(ds);
        renderTodos(ds);
      };

      const input = document.createElement("input");
      input.className = "todoText" + (t.done ? " done" : "");
      input.placeholder = "Ìï† Ïùº";
      input.value = t.text || "";
      input.oninput = () => {
        t.text = input.value;
        saveTodos(ds);
      };

      const trash = document.createElement("button");
      trash.className = "trashBtn";
      trash.title = "ÏÇ≠Ï†ú";
      trash.innerHTML = `
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
          <path d="M4 7h16" stroke="#1f2330" stroke-width="2" stroke-linecap="round"/>
          <path d="M10 11v7M14 11v7" stroke="#1f2330" stroke-width="2" stroke-linecap="round"/>
          <path d="M9 7l1-2h4l1 2" stroke="#1f2330" stroke-width="2" stroke-linecap="round"/>
          <path d="M7 7l1 14h8l1-14" stroke="#1f2330" stroke-width="2" stroke-linecap="round"/>
        </svg>
      `;
      trash.onclick = (e) => {
        e.stopPropagation();
        todos = todos.filter(x => x.id !== t.id);
        saveTodos(ds);
        renderTodos(ds);
      };

      // "Ïπ∏ÏùÑ ÌÅ¥Î¶≠ÌïòÎ©¥ Ìú¥ÏßÄÌÜµ ÎÇòÌÉÄÎÇòÎèÑÎ°ù"
      item.onclick = () => {
        document.querySelectorAll(".todoItem.active").forEach(el=>el.classList.remove("active"));
        item.classList.add("active");
      };

      item.appendChild(check);
      item.appendChild(input);
      item.appendChild(trash);
      todoListEl.appendChild(item);

      if(autofocus) setTimeout(()=>input.focus(), 0);
    }

    // Î∞îÍπ• ÌÅ¥Î¶≠ÌïòÎ©¥ active Ìï¥Ï†ú
    document.addEventListener("click", (e) => {
      const inside = e.target.closest(".todoItem");
      if(!inside){
        document.querySelectorAll(".todoItem.active").forEach(el=>el.classList.remove("active"));
      }
    });

    document.getElementById("addTodo").onclick = () => {
      const ds = ymd(current);
      const newItem = { id: crypto.randomUUID(), text:"", done:false };
      todos.push(newItem);
      saveTodos(ds);
      renderTodos(ds);
      // ÎßàÏßÄÎßâ Ìï≠Î™© Ìè¨Ïª§Ïä§
      setTimeout(()=>{
        const last = todoListEl.lastElementChild;
        last?.querySelector("input")?.focus();
        last?.classList.add("active");
      },0);
    };

    // ====== Brain dump ======
    const brainEl = document.getElementById("brainDump");
    function loadBrain(ds){
      brainEl.value = localStorage.getItem(keyBrain(ds)) || "";
    }
    brainEl.addEventListener("input", () => {
      const ds = ymd(current);
      localStorage.setItem(keyBrain(ds), brainEl.value);
    });

    // ====== TIME PLAN (hourly) ======
    const gridEl = document.getElementById("timeGrid");
    let plan = {}; // { "05:00": "..." }

    function loadPlan(ds){
      plan = JSON.parse(localStorage.getItem(keyPlan(ds)) || "{}");
    }
    function savePlan(ds){
      localStorage.setItem(keyPlan(ds), JSON.stringify(plan));
    }

    function renderTimeGrid(ds){
      gridEl.innerHTML = "";
      for(let h=START_HOUR; h<=END_HOUR; h++){
        const hh = pad2(h);
        const label = `${hh}:00`;

        const row = document.createElement("div");
        row.className = "row";

        const timeCell = document.createElement("div");
        timeCell.className = "timeCell";
        timeCell.textContent = label;

        const input = document.createElement("input");
        input.className = "planInput";
        input.placeholder = "ÏùºÏ†ï ÏûÖÎ†•";
        input.value = plan[label] || "";
        input.oninput = () => {
          plan[label] = input.value;
          savePlan(ds);
        };

        row.appendChild(timeCell);
        row.appendChild(input);
        gridEl.appendChild(row);
      }
    }

    // ====== Init ======
    renderDate();
  </script>
</body>
</html>
